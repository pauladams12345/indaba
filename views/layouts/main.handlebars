<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href='https://use.fontawesome.com/releases/v5.0.6/css/all.css' rel='stylesheet'>
    <link href='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css' rel='stylesheet' />

    <script>

        document.addEventListener('DOMContentLoaded', function() {
          let context = {};
          var startTime;
          var endTime;
          var eventLocation;
          var max_attendees;
          var calendarEl = document.getElementById('calendar');
          var modal = document.getElementById('exampleModal');
          var calendar = new FullCalendar.Calendar(calendarEl, {
            plugins: [ 'interaction', 'dayGrid', 'timeGrid', 'bootstrap' ],
            themeSystem: 'bootstrap',
            defaultView: 'timeGridWeek',
            editable: true,
            selectable: true,
            eventLimit : true,
            eventRender: function (info) {
              {description: "Lecture", department: "BioChemistry"}
            },
            header: {
              left: 'prev,next today',
              center: 'title',
              right: 'dayGridMonth,timeGridWeek,timeGridDay,listMonth'
            },
            /*dateClick: function(info) {
              startT = info.dateStr;
              calendar.addEvent({title: 'Dynamic Event', start: startT});
              alert('clicked ' + info.dateStr);
            },*/
            select: function(info) {
              startT = info.startStr;
              endT = info.endStr;
              document.getElementById("start").value = startT;
              document.getElementById("end").value = endT;
              $('#addEvent').modal('show');
              //get location and max number from form
              //call function to add event to store event
              //calendar.addEvent({title: eventLocation, start: startT, end: endT});
            }
          });
          //Used the following reference:
          //https://stackoverflow.com/questions/14207318/create-fullcalendar-calendar-event-on-submitting-the-form-in-bootstrap-modal-win
          $('#submitButton').on('click', function(e){
            e.preventDefault();
            createSlot();
          });
          function createSlot(){
            $("#addEvent").modal('hide');
            eventLocation = document.getElementById("Location").value;
            max_attendees = document.getElementById("max-attendees").value;
            calendar.addEvent({title: eventLocation, start: startT, end: endT});
           }
          calendar.render();
        });

    </script>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    {{#each stylesheets}}
   	<link rel="stylesheet" href="stylesheets/{{this}}">
    {{/each}}

    <title>Indaba</title>
  </head>
  <body>
    <div class="container-fluid px-0">

      <div id="nav-background">
        <div class="container col-12 col-lg-10 col-xl-8">
          <ul class="nav justify-content-between">
            <li class="nav-item">
              <a class="nav-link active h1 mb-0 px-0" href="#">Indaba</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle h4 px-0 mt-2" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Menu</a>
              <div class="dropdown-menu">
                <a class="dropdown-item" href="/home">Home</a>
                <a class="dropdown-item" href="#">Create New Event</a>
                <a class="dropdown-item" href="#">Past Events</a>
                <a class="dropdown-item" href="#">Past Reservations</a>
                <a class="dropdown-item" href="#">Preferences</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="/logout">Log Out</a>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <div class="container-fluid">
        <div class="row justify-content-center">
          <div class="col col-lg-10 col-xl-8">
            {{{body}}}
          </div>
        </div>
      </div>
    </div>

    {{#each scripts}}
    <script src="scripts/{{this}}"></script>
    {{/each}}

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </body>
</html>
